<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>2026WBC樹狀圖修改</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* 固定畫布真實尺寸 (以 1200px 為基準)，但在小螢幕上仍會縮放 */
    #canvas-root { width:100%; max-width:1200px; }
    #canvas { width:1200px; max-width:100%; height:490px; position:relative; border:1px dashed #cbd5e1; border-style:dashed; touch-action:none; }
    #canvas .base-img{ display:block; width:100%; height:auto; border-radius:8px; }
    #placed-layer{ position:absolute; left:0; top:0; width:100%; height:100%; pointer-events:none; }
    .placed-card{ position:absolute; pointer-events:auto; user-select:none; touch-action:none; cursor:grab; }
    .card-list{ -webkit-overflow-scrolling:touch; }
    /* 小螢幕優化：縮短內距以防止選單溢出 */
    @media (max-width: 640px){
      body{ padding:12px; }
      #canvas-root{ padding-left:8px; padding-right:8px; }
      #canvas{ border-width:1px; }

      /* .max-w-5xl > .space-y-4 > * { padding-top:6px; padding-bottom:6px; } */
    }

    /* ===== 方向鍵 Pad（鍵盤風格） ===== */
      .dir-btn{
        width:44px;
        height:44px;
        border-radius:8px;
        background:#111827;
        color:#fff;
        font-size:18px;
        font-weight:600;
        border:1px solid #374151;
        box-shadow: 0 2px 0 rgba(0,0,0,.35);
      }

      /* hover：只提亮一點點 */
      .dir-btn:hover{
        background:#1f2937;
      }

      /* 按下才是真的回饋 */
      .dir-btn:active{
        transform: translateY(1px);
        box-shadow: 0 1px 0 rgba(0,0,0,.35);
      }
      /*ICON */
      .dir-icon{
        width:18px;
        height:18px;
        fill:#fff;
        display:block;
        margin:auto;
      }

    /* ===== 速度切換按鈕 ===== */
    .speed-btn{
      width:44px;
      height:28px;
      border-radius:6px;
      font-size:12px;
      background:#fff;
      border:1px solid #cbd5e1;
    }
    .speed-btn.text-rose-600{
      border-color:#fb7185;
    }

  </style>
</head>
<body class="bg-slate-50 text-slate-800 p-6">
  <div class="max-w-5xl mx-auto space-y-4">
    <h1 class="text-lg font-semibold text-slate-900 mb-3">2026WBC樹狀圖修改</h1>
    <div class="bg-white border border-slate-200 rounded-xl shadow-sm p-4">
      <!-- Canvas 區 -->
      <div id="canvas-root" class="">
        <div id="canvas" class="bg-white" style="width:1200px; height:490px;">
          <img id="base-image" class="base-img" alt="底圖" draggable="false" width="1200" height="490" />
          <div id="placed-layer"></div>
        </div>
      </div>
    </div>

    <!-- Controls card -->
    <div class="bg-white border border-slate-200 rounded-xl shadow-sm p-4 space-y-4">
      <h2 class="text-lg font-semibold text-slate-900 mb-3">控制器區塊</h2>
      <div class="flex gap-2">
        <label class="flex-1">
          <input id="base-file" type="file" accept="image/*" class="hidden" />
          <button id="choose-base" class="w-full bg-slate-900 text-white hover:bg-slate-800 rounded-lg px-4 py-2">選擇／拖曳到底圖區</button>
        </label>
        <button id="download-btn" class="bg-slate-900 text-white hover:bg-slate-800 rounded-lg px-4 py-2">下載 PNG</button>
        <button id="clear-all" class="bg-rose-600 text-white hover:bg-rose-700 rounded-lg px-4 py-2">清除畫布</button>
      </div>

      <!-- 底圖版本 -->
      <div class="flex flex-wrap gap-2 items-center">
        <div class="text-sm text-slate-700 w-20">底圖版本：</div>
        <select id="base-preset" class="p-2 border rounded bg-white">
          <option value="pc">PC（1200×490）</option>
          <option value="msite">Msite（800×800）</option>
        </select>

        <!-- 仍保留你原本的上傳自訂底圖 -->
        <button id="apply-preset" class="bg-white border border-slate-200 hover:bg-slate-50 rounded-lg px-4 py-2 text-sm">
          套用版本
        </button>
      </div>

      <!-- 隊旗卡縮放（全域） -->
      <div class="flex flex-wrap gap-2 items-center">
        <div class="text-sm text-slate-700 w-20">隊旗縮放：</div>
        <input id="flag-scale" type="range" min="40" max="120" value="80" class="w-56" />
        <div id="flag-scale-label" class="text-sm text-slate-700">80%</div>
      </div>


      <!-- 精細位置調整控制面板 -->
      <div class="ml-2 flex items-center gap-3 select-none touch-none">
      <!-- 方向鍵（反 T） -->
      <div class="grid grid-cols-3 grid-rows-2 gap-1 items-center">

        <!-- 上：空 / 上 / 空 -->
        <div></div>
        <button id="pad-up" class="dir-btn">
          <svg viewBox="0 0 24 24" class="dir-icon">
            <path d="M12 5l7 7H5z"/>
          </svg>
        </button>
        <div></div>

        <!-- 下排：左 / 下 / 右 -->
        <button id="pad-left" class="dir-btn">
          <svg viewBox="0 0 24 24" class="dir-icon">
            <path d="M5 12l7-7v14z"/>
          </svg>
        </button>

        <button id="pad-down" class="dir-btn">
          <svg viewBox="0 0 24 24" class="dir-icon">
            <path d="M12 19l-7-7h14z"/>
          </svg>
        </button>

        <button id="pad-right" class="dir-btn">
          <svg viewBox="0 0 24 24" class="dir-icon">
            <path d="M19 12l-7 7V5z"/>
          </svg>
        </button>

      </div>
        <!-- 速度切換 -->
        <div class="flex flex-col gap-1">
          <button id="pad-step" class="speed-btn">×1</button>
          <button id="pad-step10" class="speed-btn">×10</button>
        </div>

      </div>


      <!-- 狀態按鈕：對已選卡片設定晉級/未晉級 -->
      <div class="flex gap-2 items-center">
        <div class="text-sm text-slate-700 w-20">切換狀態：</div>
        <div class="flex flex-wrap items-center gap-2">
          <button id="set-adv" class="bg-white border border-slate-200 hover:bg-slate-50 rounded-lg px-4 py-2 text-sm">設定晉級</button>
          <button id="set-elim" class="bg-white border border-slate-200 hover:bg-slate-50 rounded-lg px-4 py-2 text-sm">設定未晉級</button>
          <button id="set-clear" class="bg-white border border-slate-200 hover:bg-slate-50 rounded-lg px-4 py-2 text-sm">清除狀態</button>
        </div>
      </div>
    </div>

    <!-- 卡片清單卡片 -->
    <div class="bg-white border border-slate-200 rounded-xl shadow-sm p-4">
      <div class="mb-2 text-sm text-slate-700">下方為隊伍卡片（全部展開），PC直接拖曳卡片到上方畫布，手機點兩下再操作。</div>

      <!-- 手動產生卡片 -->
      <div class="mb-3 flex gap-2 items-center">
        <input id="manual-text" placeholder="輸入卡片文字（例如：1/23 比賽）" class="flex-1 p-2 border rounded" />
        <button id="create-manual" class="bg-slate-900 text-white hover:bg-slate-800 rounded-lg px-4 py-2">產生卡片</button>
      </div>

      <!-- 卡片列表區（全部展開、換行） -->
      <div id="card-list" class="card-list py-2">
        <div id="cards" class="flex flex-wrap gap-2 px-2"></div>
      </div>

      <div class="mt-3 text-xs text-slate-500">資料來源：Google Sheet CSV（載入後會自動產生卡片）</div>
    </div>

  </div>

  <!-- CSV table for reference -->
  <div class="bg-white border border-slate-200 rounded-xl shadow-sm p-4 max-w-5xl mx-auto mt-6">
    <h2 class="text-sm font-medium mb-2 text-slate-900">CSV 資料參考</h2>
    <div id="csv-table" class="text-sm text-slate-700 overflow-auto"></div>
  </div>

  <script src="assets/main.js"></script>
</body>
</html>
